---
title: "Import sequencing data into R"
author: "Herv√© Van der Heyden"
date: "2024-06-20"
output:
  html_document: default
  pdf_document: default
editor_options:
  markdown:
    wrap: sentence
chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align = "center")
library("knitr")
```

The First step .
. .bla bla bla .
. .



Let's start with the Illumina dataset

For these steps wee will need the following libraries

```{r, message=FALSE,echo=TRUE}
library("tidyverse")
library("phyloseq")
```

First import the ASV table

```{r}
biom_illumina<- read.csv("Raw_data/Illumina/illumina_ASV_table.tsv", 
                        header=TRUE, sep="\t")
head(biom_illumina[,1:5],10)

```

Then import the taxonomy table

```{r}
taxo_illumina<- read.csv("Raw_data/Illumina/illumina_taxonomy.tsv", 
                        header=TRUE, sep="\t")
head(taxo_illumina[,1:7],10)
```

Then define the row names from the otu column

```{r}
biom_illumina <- biom_illumina %>%
  tibble::column_to_rownames("otu") 

taxo_illumina <- taxo_illumina %>%
  tibble::column_to_rownames("otu") 
```

Transform otu and taxonomy tables into matrixes

```{r}
biom_illumina <- as.matrix(biom_illumina)
taxo_illumina <- as.matrix(taxo_illumina)

class(biom_illumina)
class(taxo_illumina) 
```

convert to phyloseq objects

```{r}
OTU_illumina = otu_table(biom_illumina, taxa_are_rows = TRUE)
TAX_illumina = phyloseq::tax_table(taxo_illumina)

illuminaPS <- phyloseq(OTU_illumina, TAX_illumina)
illuminaPS
```

Let's repeat for the IonTorrent dataset 

```{r}
biom_IonTorrent<- read.csv("Raw_data/IonTorrent/iontorrent_ASV_table.tsv", 
                        header=TRUE, sep="\t")
head(biom_IonTorrent[,1:5],10)


taxo_IonTorrent<- read.csv("Raw_data/IonTorrent/iontorrent_taxonomy.tsv", 
                        header=TRUE, sep="\t")
head(taxo_IonTorrent[,1:7],10)

biom_IonTorrent <- biom_IonTorrent %>%
  tibble::column_to_rownames("otu") 

taxo_IonTorrent <- taxo_IonTorrent %>%
  tibble::column_to_rownames("otu") 


biom_IonTorrent <- as.matrix(biom_IonTorrent)
taxo_IonTorrent <- as.matrix(taxo_IonTorrent)

class(biom_IonTorrent)
class(taxo_IonTorrent) 

OTU_IonTorrent = otu_table(biom_IonTorrent, taxa_are_rows = TRUE)
TAX_IonTorrent = phyloseq::tax_table(taxo_IonTorrent)

IonTorrentPS <- phyloseq(OTU_IonTorrent, TAX_IonTorrent)
IonTorrentPS
```

And Again for the Nanopore dataset 

```{r}
biom_Nanopore<- read.csv("Raw_data/Nanopore/Nanopore_pseudo_ASV_table.csv", 
                        header=TRUE, sep=";")
head(biom_Nanopore[,1:5],10)


taxo_Nanopore<- read.csv("Raw_data/Nanopore/Nanopore_taxonomy.csv", 
                        header=TRUE, sep=",")
head(taxo_Nanopore[,1:7],10)

biom_Nanopore <- biom_Nanopore %>%
  tibble::column_to_rownames("otu") 

taxo_Nanopore <- taxo_Nanopore %>%
  tibble::column_to_rownames("otu") 


biom_Nanopore <- as.matrix(biom_Nanopore)
taxo_Nanopore <- as.matrix(taxo_Nanopore)

class(biom_Nanopore)
class(taxo_Nanopore) 

OTU_Nanopore = otu_table(biom_Nanopore, taxa_are_rows = TRUE)
TAX_Nanopore = phyloseq::tax_table(taxo_Nanopore)

NanoporePS <- phyloseq(OTU_Nanopore, TAX_Nanopore)
NanoporePS
```

