% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Import sequencing data into R},
  pdfauthor={Hervé Van der Heyden},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Import sequencing data into R}
\author{Hervé Van der Heyden}
\date{2024-06-20}

\begin{document}
\maketitle

The First step . . .bla bla bla . . .

Let's start with the Illumina dataset

For these steps wee will need the following libraries

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(}\StringTok{"tidyverse"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(}\StringTok{"phyloseq"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

First import the ASV table

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{biom\_illumina}\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"1\_Raw\_data/Illumina/illumina\_ASV\_table.tsv"}\NormalTok{, }
                        \AttributeTok{header=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{sep=}\StringTok{"}\SpecialCharTok{\textbackslash{}t}\StringTok{"}\NormalTok{)}
\FunctionTok{head}\NormalTok{(biom\_illumina)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                                otu QC0221WK20 QC0221WK21 QC0221WK22 QC0221WK23
## 1 f556cceb09c61e1530d00b7d1aed8234          0          0          0          0
## 2 353c06adc7d2edfcfaebf59bbe3ff76e        400          0       2617          0
## 3 9b00bc511c2b9d7b833604813b0b05f2        510       1678       1870       6213
## 4 9e1dc7d16af91d5c34643b33f8f13694          0          0          0          0
## 5 d87923a926982434c811a4fc33a7942f        435       3938        574          0
## 6 9ed6ed511e00f993f42bc338c94d55eb       7513       5636       1616       2387
##   QC0221WK24 QC0221WK25 QC0221WK26 QC0221WK27 QC0221WK28 QC0221WK29 QC0221WK30
## 1          0          0          0          0        872       8032      17780
## 2         74          0          0          0        122          0         82
## 3       5010       2812       3140       2745       5393       2147        824
## 4        114          0          0         71          0        325        220
## 5          0        141        572          0          0        270          0
## 6       2224       1577        967       5907          0        800        281
##   QC0221WK31 QC0221WK32 QC0221WK33 QC0221WK34 QC0221WK35 QC0221WK36 QC0221WK37
## 1      16025      13653      14856      19444      14736      10780       1216
## 2        128          0          0          0        609       3753      25267
## 3        724          0          0          0        804        670        298
## 4         20          0          0          0        447       1254        159
## 5         80          0          0          0          0          0          0
## 6        202       3345          0          0        352          0          0
##   QC0321WK21 QC0321WK22 QC0321WK23 QC0321WK24 QC0321WK25 QC0321WK26 QC0321WK27
## 1          0          0          0          0          0          0       2127
## 2          0       1126          0          0        258        248        567
## 3          0       1830       4855       4357       3245       1977       2203
## 4          0          0        379          0          0        257       1618
## 5       3247        628        915        388          0        700          0
## 6       5454       8934          0       2795       1430        850        658
##   QC0321WK28 QC0321WK29 QC0321WK30 QC0321WK31 QC0321WK32 QC0321WK33 QC0321WK34
## 1       3183      12952      18088      11338      10255       7971       3156
## 2        285        513        106          0         71          0          0
## 3        725       1096          0        675        205          0          0
## 4       1193        285        132       1088        159          0          0
## 5          0          0          0          0          0          0          0
## 6          0        575          0        317         58          0          0
##   QC0321WK35 QC0321WK36 QC0321WK37 QC0421WK22 QC0421WK23 QC0421WK24 QC0421WK25
## 1      14148       2695          0          0          0          0          0
## 2        795      10063      26619      11569       2897       1251       1226
## 3        534       1067          0       2289       3312       2942       1259
## 4          0       1282        511          0          0          0          0
## 5          0          0          0        305          0          0          0
## 6        450        795          0        388          0        392          0
##   QC0421WK26 QC0421WK27 QC0421WK28 QC0421WK29 QC0421WK30 QC0421WK31 QC0421WK32
## 1          0          0        218       1145       2326       3108       4583
## 2       1814        588        414        489        191        118          0
## 3          0          0        610        434          0        290        495
## 4          0       1783          0          0        687          0          0
## 5         64          0          0          0          0          0          0
## 6          0          0         34          0          0          0          0
##   QC0421WK33 QC0421WK34 QC0421WK35 QC0421WK36 QC0421WK37 QC0521WK22 QC0521WK23
## 1      12860       5720       1066          0         70          0          0
## 2         84         66       1485       3630       6802       2021          0
## 3          0          0          0          0        554       1284       2954
## 4        122        467          0        668        139         95          0
## 5          0          0          0        185          0        286        576
## 6          0          0          0          0         34       3907          0
##   QC0521WK24 QC0521WK25 QC0521WK26 QC0521WK27 QC0521WK28 QC0521WK29 QC0521WK30
## 1          0          0          0       1305       2714       9299       9826
## 2       1742        156       4015       2300        819          0        229
## 3       1812        348       1091       2135        483        894        938
## 4       1518          0        416       1572          0        121        513
## 5        711        673        345          0          0         93          0
## 6        212        487          0        279          0        433        139
##   QC0521WK31 QC0521WK32 QC0521WK33 QC0521WK34 QC0521WK35 QC0521WK36 QC0521WK37
## 1       6933       9131      12795       5091      12960       1600       1851
## 2         59          0          0          0         85       4388      11436
## 3        205        119          0          0        730        751        804
## 4        227          0         51          0       1066       1048        761
## 5          0          0          0          0          0          0        226
## 6          0          0          0          0        274        230        154
##   QC0621WK22 QC0621WK23 QC0621WK24 QC0621WK25 QC0621WK26 QC0621WK27 QC0621WK28
## 1          0          0          0          0          0         17          0
## 2          0          0          0          0          0          0          0
## 3        568       2158       1835        264        290          0          0
## 4          0          0        463          0          0       9649       5535
## 5       1106       6203       6927       6265       5814          0          0
## 6        805        164        566          0          0          0          0
##   QC0621WK29 QC0621WK30 QC0621WK31 QC0621WK32 QC0621WK33 QC0621WK34 QC0621WK35
## 1        717       4924      10660      12003      13122       9237       5884
## 2          0         86          0          0          0          0          0
## 3          0          0          0          0          0          0          0
## 4       2123        849       1730          0         33          0        402
## 5          0          0          0          0          0          0          0
## 6          0          0          0          0          0          0          0
##   QC0621WK36 QC0621WK37 QC0721WK22 QC0721WK23 QC0721WK24 QC0721WK25 QC0721WK26
## 1       3706        317          0          0          0          0          0
## 2        487       8025          0          0        588       2321       7846
## 3          0          0          0       3017       2947       1383        767
## 4       5154       2847          0          0        351        181          0
## 5          0          0          0          0        392       1114        571
## 6          0          0       1675          0       2288        413          0
##   QC0721WK27 QC0721WK28 QC0721WK29 QC0721WK30 QC0721WK31 QC0721WK32 QC0721WK33
## 1          0         80        438          0       2000       2633       9771
## 2       1917        925        178         30        437        113          0
## 3          0        284          0          0          0          0          0
## 4       1120        406       1048       5800       2778          0          0
## 5          0          0          0          0          0          0          0
## 6          0          0          0          0          0          0          0
##   QC0721WK34 QC0721WK35 QC0721WK36 QC0721WK37 QC0821WK25 QC0821WK26 QC0821WK27
## 1       8143        118          0          0          0          0          0
## 2          0          0          0         75          0          0          0
## 3        151          0          0          0        480        277          0
## 4          0          0          0          0          0       2975          0
## 5          0          0          0          0      13650       6867        628
## 6          0          0          0          0        639          0          0
##   QC0821WK28 QC0821WK29 QC0821WK30 QC0821WK31 QC0821WK32 QC0821WK33 QC0821WK34
## 1         45       1912        158       1652       4516       8244       1981
## 2          0          0          0          0          0          0          0
## 3          0        496          0        818          0          0          0
## 4          0        142          0          0          0          0          0
## 5       1488       2865          0          0          0          0          0
## 6          0          0          0          0          0          0          0
##   QC0821WK35 QC0821WK36 QC0821WK37
## 1       1153        831          0
## 2          0        122      14202
## 3          0          0          0
## 4       8181       9260       4941
## 5          0          0          0
## 6          0          0          0
\end{verbatim}

Then import the taxonomy table

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{taxo\_illumina}\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"1\_Raw\_data/Illumina/illumina\_taxonomy.tsv"}\NormalTok{, }
                        \AttributeTok{header=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{sep=}\StringTok{"}\SpecialCharTok{\textbackslash{}t}\StringTok{"}\NormalTok{)}
\FunctionTok{head}\NormalTok{(taxo\_illumina)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                                otu      Kingdom      Phylum            Class
## 1 f556cceb09c61e1530d00b7d1aed8234 k__Eukaryota p__Oomycota c__Stramenopiles
## 2 353c06adc7d2edfcfaebf59bbe3ff76e k__Eukaryota p__Oomycota c__Stramenopiles
## 3 9b00bc511c2b9d7b833604813b0b05f2 k__Eukaryota p__Oomycota c__Stramenopiles
## 4 9e1dc7d16af91d5c34643b33f8f13694 k__Eukaryota p__Oomycota c__Stramenopiles
## 5 d87923a926982434c811a4fc33a7942f k__Eukaryota p__Oomycota c__Stramenopiles
## 6 9ed6ed511e00f993f42bc338c94d55eb k__Eukaryota p__Oomycota c__Stramenopiles
##               Order             Family          Genus                   Species
## 1 o__Peronosporales f__Peronosporaceae g__Peronospora s__Peronospora_manshurica
## 2 o__Peronosporales f__Peronosporaceae g__Peronospora s__Peronospora_destructor
## 3 o__Peronosporales f__Peronosporaceae g__Peronospora s__Peronospora_variabilis
## 4 o__Peronosporales f__Peronosporaceae      g__Bremia       s__Bremia_elliptica
## 5    o__Albuginales    f__Albuginaceae      g__Albugo         s__Albugo_candida
## 6 o__Peronosporales f__Peronosporaceae g__Peronospora   s__Peronospora_aparines
\end{verbatim}

Then define the row names from the otu column

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{biom\_illumina }\OtherTok{\textless{}{-}}\NormalTok{ biom\_illumina }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  tibble}\SpecialCharTok{::}\FunctionTok{column\_to\_rownames}\NormalTok{(}\StringTok{"otu"}\NormalTok{) }

\NormalTok{taxo\_illumina }\OtherTok{\textless{}{-}}\NormalTok{ taxo\_illumina }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  tibble}\SpecialCharTok{::}\FunctionTok{column\_to\_rownames}\NormalTok{(}\StringTok{"otu"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

Transform otu and taxonomy tables into matrixes

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{biom\_illumina }\OtherTok{\textless{}{-}} \FunctionTok{as.matrix}\NormalTok{(biom\_illumina)}
\NormalTok{taxo\_illumina }\OtherTok{\textless{}{-}} \FunctionTok{as.matrix}\NormalTok{(taxo\_illumina)}

\FunctionTok{class}\NormalTok{(biom\_illumina)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "matrix" "array"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{class}\NormalTok{(taxo\_illumina) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "matrix" "array"
\end{verbatim}

convert to phyloseq objects

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{OTU\_illumina }\OtherTok{=} \FunctionTok{otu\_table}\NormalTok{(biom\_illumina, }\AttributeTok{taxa\_are\_rows =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{TAX\_illumina }\OtherTok{=}\NormalTok{ phyloseq}\SpecialCharTok{::}\FunctionTok{tax\_table}\NormalTok{(taxo\_illumina)}

\NormalTok{illuminaPS }\OtherTok{\textless{}{-}} \FunctionTok{phyloseq}\NormalTok{(OTU\_illumina, TAX\_illumina)}
\NormalTok{illuminaPS}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 324 taxa and 112 samples ]
## tax_table()   Taxonomy Table:    [ 324 taxa by 7 taxonomic ranks ]
\end{verbatim}

\end{document}
